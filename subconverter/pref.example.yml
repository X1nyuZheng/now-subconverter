common:
  api_mode: false
  api_access_token: password
  default_url: []
  enable_insert: true
  insert_url: []
  prepend_insert_url: true
  exclude_remarks: ["(到期|剩余流量|时间|官网|产品|平台)"]
  include_remarks: []
  enable_filter: false
  filter_script: ""
  default_external_config: "" # config/example_external_config.yml
  base_path: base
  clash_rule_base: base/all_base.tpl
  surge_rule_base: base/all_base.tpl
  surfboard_rule_base: base/all_base.tpl
  mellow_rule_base: base/all_base.tpl
  quan_rule_base: base/all_base.tpl
  quanx_rule_base: base/all_base.tpl
  loon_rule_base: base/all_base.tpl
  sssub_rule_base: base/all_base.tpl
  proxy_config: SYSTEM
  proxy_ruleset: SYSTEM
  proxy_subscription: NONE
  append_proxy_type: false

userinfo:
  stream_rule: 
  - {match: "^剩余流量：(.*?)\\|总流量：(.*)$", replace: "total=$2&left=$1"}
  - {match: "^剩余流量：(.*?) (.*)$", replace: "total=$1&left=$2"}
  - {match: "^Bandwidth: (.*?)/(.*)$", replace: "used=$1&total=$2"}
  - {match: "^.*剩余(.*?)(?:\\s*?)@(?:.*)$", replace: "total=$1"}
  - {match: "^.*?流量:(.*?) 剩:(?:.*)$", replace: "total=$1"}
  time_rule:
  - {match: "^过期时间：(\\d+)-(\\d+)-(\\d+) (\\d+):(\\d+):(\\d+)$", replace: "$1:$2:$3:$4:$5:$6"}
  - {match: "^到期时间(:|：)(\\d+)-(\\d+)-(\\d+)$", replace: "$1:$2:$3:0:0:0"}
  - {match: "^Smart Access expire: (\\d+)/(\\d+)/(\\d+)$", replace: "$1:$2:$3:0:0:0"}
  - {match: "^.*?流量:(?:.*?) 剩:(.*?)天$", replace: "left=$1d"}

node_pref:
#  udp_flag: false
#  tcp_fast_open_flag: false
#  skip_cert_verify_flag: false
#  tls13_flag: false
  sort_flag: false
  sort_script: ""
  filter_deprecated_nodes: false
  append_sub_userinfo: true
  clash_use_new_field_name: true
  clash_proxies_style: flow
  rename_node:
#  - {match: "\\(?((x|X)?(\\d+)(\\.?\\d+)?)((\\s?倍率?)|(x|X))\\)?", replace: "$1x"}
#  - {script: "function rename(node){}"}
#  - {script: "path:/path/to/script.js"}
  - {import: snippets/rename_node.txt}

managed_config:
  write_managed_config: true
  managed_config_prefix: "http://127.0.0.1:25500"
  config_update_interval: 86400
  config_update_strict: false
  quanx_device_id: ""

surge_external_proxy:
  surge_ssr_path: "" # /usr/bin/ssr-local
  resolve_hostname: true

emojis:
  add_emoji: true
  remove_old_emoji: true
  rules:
#  - {match: "(流量|时间|应急)", emoji: "🏳️‍🌈"}
#  - {script: "function getEmoji(node){}"}
#  - {script: "path:/path/to/script.js"}
#  - {import: snippets/emoji.txt}
  - {match: "(?i:Bandwidth|expire|流量|时间|应急|过期)", emoji: "🏳️‍🌈"}
  - {match: "(?i:\\bHK[G]?\\b|Hong.*?Kong|\\bHKT\\b|\\bHKBN\\b|\\bHGC\\b|\\bWTT\\b|\\bCMI\\b|[^-]港)", emoji: "🇭🇰"}
  - {match: "(?i:\\bTW[N]?\\b|Taiwan|新北|彰化|\\bCHT\\b|台湾|[^-]台|\\bHINET\\b)", emoji: "🇼🇸"}
  - {match: "(?i:\\bSG[P]?\\b|Singapore|新加坡|狮城|[^-]新)", emoji: "🇸🇬"}
  - {match: "(?i:\\bJP[N]?\\b|Japan|Tokyo|Osaka|Saitama|日本|东京|大阪|埼玉|[^-]日)", emoji: "🇯🇵"}
  - {match: "(?i:\\bK[O]?R\\b|Korea|首尔|韩|韓)", emoji: "🇰🇷"}
  - {match: "(?i:\\bUS[A]?\\b|America|United.*?States|美国|[^-]美|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥)", emoji: "🇺🇸"}
  - {match: "(Ascension|阿森松)", emoji: "🇦🇨"}
  - {match: "(?i:\\bUAE\\b|Dubai|阿联酋|迪拜)", emoji: "🇦🇪"}
  - {match: "(阿尔巴尼亚|Albania)", emoji: "🇦🇱"}
  - {match: "(Argentina|阿根廷)", emoji: "🇦🇷"}
  - {match: "(Austria|Vienna|奥地利|维也纳)", emoji: "🇦🇹"}
  - {match: "(?i:\\bAU[S]?\\b|Australia|Sydney|澳大利亚|澳洲|悉尼)", emoji: "🇦🇺"}
  - {match: "(阿塞拜疆|Azerbaijan)", emoji: "🇦🇿"}
  - {match: "(波黑共和国|波士尼亚与赫塞哥维纳|Bosnia|Herzegovina)", emoji: "🇧🇦"}
  - {match: "(Belgium|比利时)", emoji: "🇧🇪"}
  - {match: "(保加利亚|Bulgaria)", emoji: "🇧🇬"}
  - {match: "(Brazil|Paulo|巴西|圣保罗)", emoji: "🇧🇷"}
  - {match: "(?i:\\bCA[N]?\\b|Canada|Toronto|Montreal|Vancouver|加拿大|蒙特利尔|温哥华|楓葉|枫叶)", emoji: "🇨🇦"}
  - {match: "(Switzerland|Zurich|瑞士|苏黎世)", emoji: "🇨🇭"}
  - {match: "(智利|Chile)", emoji: "🇨🇱"}
  - {match: "(Colombia|哥伦比亚)", emoji: "🇨🇴"}
  - {match: "(Costa Rica|哥斯达黎加)", emoji: "🇨🇷"}
  - {match: "(塞浦路斯|Cyprus)", emoji: "🇨🇾"}
  - {match: "(Czech|捷克)", emoji: "🇨🇿"}
  - {match: "(?i:\\bDE[U]?\\b|Germany|法兰克福|德(国|意志)|中德|^德$)", emoji: "🇩🇪"}
  - {match: "(?i:\\bD[N]?K\\b|Denmark|丹麦)", emoji: "🇩🇰"}
  - {match: "(爱沙尼亚|Estonia)", emoji: "🇪🇪"}
  - {match: "(埃及|Egypt)", emoji: "🇪🇬"}
  - {match: "(?i:\\bES[P]?\\b|Spain|西班牙)", emoji: "🇪🇸"}
  - {match: "(Europe|欧洲)", emoji: "🇪🇺"}
  - {match: "(Finland|Helsinki|芬兰|赫尔辛基)", emoji: "🇫🇮"}
  - {match: "(?i:\\bFR[A]?\\b|France|Paris|法国|巴黎)", emoji: "🇫🇷"}
  - {match: "(?i:\\bUK\\b|\\bGB[R]?\\b|England|United.*?Kingdom|London|英国|[^-]英|伦敦)", emoji: "🇬🇧"}
  - {match: "(希腊|Greece)", emoji: "🇬🇷"}
  - {match: "(格鲁吉亚|Georgia)", emoji: "🇬🇪"}
  - {match: "(克罗地亚|Croatia)", emoji: "🇭🇷"}
  - {match: "(Hungary|匈牙利)", emoji: "🇭🇺"}
  - {match: "(Indonesia|Jakarta|印尼|印度尼西亚|雅加达)", emoji: "🇮🇩"}
  - {match: "(Ireland|Dublin|爱尔兰|都柏林)", emoji: "🇮🇪"}
  - {match: "(Israel|以色列)", emoji: "🇮🇱"}
  - {match: "(马恩岛|Mann)", emoji: "🇮🇲"}
  - {match: "(?i:\\bIN[D]?\\b|India|Mumbai|印度|孟买|加尔各答|贾坎德|泰米尔纳德)", emoji: "🇮🇳"}
  - {match: "(伊朗|Iran)", emoji: "🇮🇷"}
  - {match: "(?i:\\bIS[L]?\\b|Iceland|冰岛)", emoji: "🇮🇸"}
  - {match: "(Italy|Milan|意大利|米兰)", emoji: "🇮🇹"}
  - {match: "(约旦|Jordan)", emoji: "🇯🇴"}
  - {match: "(肯尼亚|Kenya)", emoji: "🇰🇪"}
  - {match: "(吉尔吉斯斯坦|Kyrgyzstan)", emoji: "🇰🇬"}
  - {match: "(柬埔寨|Cambodia)", emoji: "🇰🇭"
  - {match: "(North.*?Korea|朝鲜)", emoji: "🇰🇵"}
  - {match: "(哈萨克斯坦|Kazakhstan)", emoji: "🇰🇿"}
  - {match: "(立陶宛|Lietuvos)", emoji: "🇱🇹"}
  - {match: "(卢森堡|Luxemburg|Luxembourg)", emoji: "🇱🇺"}
  - {match: "(拉脱维亚|Latvia)", emoji: "🇱🇻"}
  - {match: "(Moldova|摩尔多瓦)", emoji: "🇲🇩"}
  - {match: "(北马其顿|Macedonia)", emoji: "🇲🇰"}
  - {match: "(蒙古|Монголулс|Mongolia)", emoji: "🇲🇳"}
  - {match: "(Macao|澳门|\\bCTM\\b)", emoji: "🇲🇴"}
  - {match: "(墨西哥|Mexico)", emoji: "🇲🇽"}
  - {match: "(Malaysia|马来西亚)", emoji: "🇲🇾"}
  - {match: "(尼日利亚|Nigeria)", emoji: "🇳🇬"}
  - {match: "(?i:\\bNL[D]?\\b|Netherlands|荷兰|阿姆斯特丹)", emoji: "🇳🇱"}
  - {match: "(挪威|Norway)", emoji: "🇳🇴"}
  - {match: "(新西兰|纽西兰|New Zealand)", emoji: "🇳🇿"}
  - {match: "(Philippines|菲律宾)", emoji: "🇵🇭"}
  - {match: "(Pakistan|巴基斯坦)", emoji: "🇵🇰"}
  - {match: "(?i:\\bP[O]?L\\b|Poland|波兰)", emoji: "🇵🇱"}
  - {match: "(巴拿马|Panama)", emoji: "🇵🇦"}
  - {match: "(秘鲁|Peru)", emoji: "🇵🇪"}
  - {match: "(葡萄牙|Portugal)", emoji: "🇵🇹"}
  - {match: "(Romania|罗马尼亚)", emoji: "🇷🇴"}
  - {match: "(塞尔维亚|Serbia)", emoji: "🇷🇸"}
  - {match: "(?i:\\bRU[S]?\\b|Russia|Moscow|Petersburg|Siberia|伯力|莫斯科|圣彼得堡|西伯利亚|新西伯利亚|哈巴罗夫斯克|俄罗斯|[^-]俄)", emoji: "🇷🇺"}
  - {match: "(Arabia|沙特)", emoji: "🇸🇦"}
  - {match: "(Sweden|瑞典)", emoji: "🇸🇪"}
  - {match: "(斯洛文尼亚|Slovenia)", emoji: "🇸🇮"}
  - {match: "(斯洛伐克|Slovensko)", emoji: "🇸🇰"}
  - {match: "(Thailand|泰国|曼谷)", emoji: "🇹🇭"}
  - {match: "(突尼斯|Tunisia)", emoji: "🇹🇳"}
  - {match: "(Turkey|土耳其|伊斯坦布尔)", emoji: "🇹🇷"}
  - {match: "(乌拉圭|Uruguay)", emoji: "🇺🇾"}
  - {match: "(Vietnam|越南)", emoji: "🇻🇳"}
  - {match: "(Africa|南非)", emoji: "🇿🇦"}
  - {match: "(?i:\\bC[H]?N\\b|China|回国|中国[^-]|江苏[^-]|北京[^-]|上海[^-]|广州[^-]|深圳[^-]|杭州[^-]|常州[^-]|徐州[^-]|青岛[^-]|宁波[^-]|镇江[^-]|成都[^-]|back)", emoji: "🇨🇳"

rulesets:
  enabled: true
  overwrite_original_rules: false
  update_ruleset_on_request: false
  rulesets:
#  - {rule: "GEOIP,CN", group: "DIRECT"}
#  - {ruleset: "rules/LocalAreaNetwork.list", group: "DIRECT"}
#  - {ruleset: "surge:rules/LocalAreaNetwork.list", group: "DIRECT"}
#  - {ruleset: "quanx:https://raw.githubusercontent.com/ConnersHua/Profiles/master/Quantumult/X/Filter/Advertising.list", group: "Advertising", interval: 86400}
#  - {ruleset: "clash-domain:https://ruleset.dev/clash_domestic_services_domains", group: "Domestic Services", interval: 86400}
#  - {ruleset: "clash-ipcidr:https://ruleset.dev/clash_domestic_services_ips", group: "Domestic Services", interval: 86400}
#  - {ruleset: "clash-classic:https://raw.githubusercontent.com/DivineEngine/Profiles/master/Clash/RuleSet/China.yaml", group: "DIRECT", interval: 86400}
  - {import: snippets/rulesets.txt}

proxy_groups:
  custom_proxy_group:
#  - {name: UrlTest, type: url-test, rule: [".*"], url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 100, timeout: 5}
#  - {name: Proxy, type: select, rule: [".*"]}
#  - {name: group1, type: select, rule: ["!!GROUPID=0"]}
#  - {name: v2ray, type: select, rule: ["!!GROUP=V2RayProvider"]}
#  - {import: snippets/groups_forcerule.txt}
#  - {name: ssid group, type: ssid, rule: ["default_group", "celluar=group0,ssid1=group1,ssid2=group2"]}
  - {import: snippets/groups.txt}

template:
  template_path: ""
  globals:
  - {key: clash.http_port, value: 7890}
  - {key: clash.socks_port, value: 7891}
  - {key: clash.allow_lan, value: true}
  - {key: clash.log_level, value: info}
  
aliases:
  - {uri: /v, target: /version}
  - {uri: /clash, target: "/sub?target=clash"}
  - {uri: /clashr, target: "/sub?target=clashr"}
  - {uri: /surge, target: "/sub?target=surge"}
  - {uri: /quan, target: "/sub?target=quan"}
  - {uri: /quanx, target: "/sub?target=quanx"}
  - {uri: /mellow, target: "/sub?target=mellow"}
  - {uri: /surfboard, target: "/sub?target=surfboard"}
  - {uri: /loon, target: "/sub?target=loon"}
  - {uri: /ss, target: "/sub?target=ss"}
  - {uri: /ssd, target: "/sub?target=ssd"}
  - {uri: /sssub, target: "/sub?target=sssub"}
  - {uri: /ssr, target: "/sub?target=ssr"}
  - {uri: /v2ray, target: "/sub?target=v2ray"}
  - {uri: /trojan, target: "/sub?target=trojan"}

tasks:
#  - name: tick
#    cronexp: "0/10 * * * * ?"
#    path: tick.js
#    timeout: 3

server:
  listen: 0.0.0.0
  port: 25500
  serve_file_root: ""

advanced:
  log_level: info
  print_debug_info: false
  max_pending_connections: 10240
  max_concurrent_threads: 2
  max_allowed_rulesets: 0
  max_allowed_rules: 0
  max_allowed_download_size: 0
  enable_cache: false
  cache_subscription: 60
  cache_config: 300
  cache_ruleset: 21600
  script_clean_context: true
  async_fetch_ruleset: false
  skip_failed_links: false
